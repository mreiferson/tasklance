{% extends "content.html" %}
{% load custom_tags %}

{% block title %}Overview - {{ block.super }}{% endblock %}

{% block content %}
{% include "milestones_css.html" %}
<style type="text/css">
	#milestonesHeader {
		margin-top: 10px;
	}
	.msMeta {
		width: 500px;
	}
</style>
<table cellspacing="0" id="overviewContainer">
	<tr>
		<td style="vertical-align: top;">
			<div id="account" rel="{{ request.account.id }}">
				<div id="categories">
					{% for category in request.account.category_set.all %}
					<div id="category{{ category.id }}" rel="{{ category.id }}" class="category">
						<h1><a href="{% url pm_delcategory category.id %}"><img src="/site_media/images/report_delete.gif" alt="Delete Category"/></a> <a href="{% url pm_overview category.id %}"><span class="categoryName" rel="name">{{ category.name }}</span></a></h1>
						<div class="categoryDescription" rel="description">{{ category.description }}</div>
						<div id="milestonesHeader">Milestones:</div>
						<div id="milestones">
							{% for milestone in category.milestone_set.all %}
								<div id="milestone{{ milestone.id }}" class="milestone floatContainer">
									<div class="msPercCompleted">{{ milestone.perc_completed|floatformat:2 }}%</div>
									<div class="msMeta">
										<div class="msName">{{ milestone.name }}</div>
										<div class="msDescription">{{ milestone.description }}</div>
										<div class="msDeadline">started <strong>{{ milestone.created|date:"Y-m-d" }}</strong> - deadline <strong>{{ milestone.deadline|date:"Y-m-d" }}</strong> - <strong>{{ milestone.days_remaining.days }}</strong> day{% ifnotequal milestone.days_remaining.days 1 %}s{% endifnotequal %} remaining</div>
									</div>
								</div>
							{% endfor %}
						</div>
						{% show_history category %}
					</div>
					{% endfor %}
				</div>
			</div>
		</td>
		<td style="vertical-align: top;">
			<div id="manage">
				<div class="addCategoryContainer">
					<div class="addHeader">Add Category</div>
					{% include "addcategory.html" %}
				</div>
				<div class="loadContainer">
					<div class="addHeader">Load From XML</div>
					{% include "load.html" %}
				</div>
				<div class="links">
					<div class="addHeader">Quick Links / Re-order</div>
					<ul class="categoryLinks" rel="category">
						{% for category in request.account.category_set.all %}
						<li class="categoryLink" rel="{{ category.id }}"><span class="handle"><img src="/site_media/images/list_ordered.gif"/></span> <a href="#category{{ category.id }}">{{ category.name }}</a>
							<ul class="projectLinks" rel="project">
							{% for project in category.project_set.all %}
								<li class="projectLink" rel="{{ project.id }}"><span class="handle"><img src="/site_media/images/list_ordered.gif"/></span> <a href="#project{{ project.id }}">{{ project.name }}</a></li>
							{% endfor %}
							</ul>
						</li>
						{% endfor %}
					</ul>
				</div>
			</div>
		</td>
	</tr>
</table>
{% endblock %}
