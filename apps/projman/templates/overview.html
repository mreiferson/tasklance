{% extends "category.html" %}

{% block title %}Overview - {{ block.super }}{% endblock %}

{% block content %}
<style type="text/css">
	.date {
		margin-bottom: 25px;
		border-top: 2px solid #eee;
		clear: both;
	}
	
	.date .dateInnerContainer {
		margin-left: 20px;
	}
	
	.date .dateHeader {
		font-weight: bold;
		color: #444;
		margin: 2px 0 10px 2px;
		font-size: 12px;
	}
	
	.item {
		margin: 2px 0;
		clear: both;
	}
	
	.item .itemType {
		font-weight: bold;
		color: #fff;
		float: left;
		margin-right: 5px;
		padding: 5px;
		width: 65px;
		text-align: right;
	}
	
	.itemType.task {
		background: #C4BCE9;
	}
	
	.itemType.message {
		background: #FB5200;
	}
	
	.itemType.milestone {
		background: #C13992;
	}
	
	.itemType.task.complete {
		background: #7766CC;
	}
	
	.item .itemStamp {
		color: #888;
		float: left;
		margin-right: 5px;
		padding-top: 4px;
		width: 65px;
	}
	
	.item .itemText {
		float: left;
		padding-top: 4px;
		width: 600px;
	}
	
	.item .itemProject {
		font-weight: bold;
	}
	
	.itemText.completed {
		text-decoration: line-through;
	}
	
	#milestonesHeader, #chronologyHeader {
		font-size: 14px;
		font-weight: bold;
		margin-bottom:1em;
	}
	
	#milestones, #chronology {
		margin: 0 35px 1em 35px;
	}
	
	.milestone {
		margin-bottom: 1em;
	}
	
	.milestone .msPercCompleted {
		text-align: center;
		font-size: 18px;
		font-weight: bold;
		font-family: Georgia;
		color: #fff;
		padding: 6px;
		background: #DE70AA;
		float: left;
		margin-right: 5px;
	}
	
	.milestone .msDeadline {
		float: right;
		font-size: 12px;
		color: #666;
		text-align: right;
	}
	
	.milestone .msName {
		float: left;
		font-weight: bold;
		font-size: 12px;
		color: #C62D7D;
	}
	
	.milestone .msDescription {
		font-size: 10px;
		font-weight: normal;
		padding: 5px 0;
		color: #666;
	}
</style>
<div id="milestonesHeader">Milestones:</div>
<div id="milestones">
	{% for milestone in category.milestone_set.all %}
		<div id="milestone{{ milestone.id }}" class="milestone floatContainer">
			<div class="msPercCompleted">{{ milestone.perc_completed|floatformat:2 }}%</div>
			<div class="msName">{{ milestone.name }}<div class="msDescription">{{ milestone.description }}</div></div>
			<div class="msDeadline">started <strong>{{ milestone.created|date:"Y-m-d" }}</strong> - deadline <strong>{{ milestone.deadline|date:"Y-m-d" }}</strong><br/><strong>{{ milestone.days_remaining.days }}</strong> day{% ifnotequal milestone.days_remaining.days 1 %}s{% endifnotequal %} remaining</div>
		</div>
	{% endfor %}
</div>
<div id="chronologyHeader">Chronology:</div>
<div id="chronology">
	{% for datelist in items %}
		<div class="date">
			<div class="dateHeader">{{ datelist.0 }}</div>
			<div class="dateInnerContainer">
				{% for e in datelist.1 %}
					{% ifequal e.2 'task' %}
						<div class="item floatContainer">
							<div class="itemType {{ e.2 }} {% if e.3.complete %} complete{% endif %}">{% if e.3.complete %}<img src="/site_media/images/accept.gif"/> {% endif %}{{ e.2|capfirst }}</div>
							<div class="itemStamp">{{ e.1 }}</div>
							<div class="itemText{% if e.3.completed %} completed{% endif %}">{{ e.3.item }} (<span class="itemProject">{{ e.3.project.name }}</span>)</div>
						</div>
					{% endifequal %}
					{% ifequal e.2 'message' %}
						<div class="item floatContainer">
							<div class="itemType {{ e.2 }}">{{ e.2|capfirst }}</div>
							<div class="itemStamp">{{ e.1 }}</div>
							<div class="itemText"><strong>{{ e.3.creator.username }}</strong>: {{ e.3.text }}</div>
						</div>
					{% endifequal %}
					{% ifequal e.2 'milestone' %}
						<div class="item floatContainer">
							<div class="itemType {{ e.2 }}">{{ e.2|capfirst }}</div>
							<div class="itemStamp">{{ e.1 }}</div>
							<div class="itemText"><strong>{{ e.3.name }}</strong>: {{ e.3.description }}</div>
						</div>
					{% endifequal %}
				{% endfor %}
			</div>
		</div>
	{% endfor %}
</div>
{% endblock %}